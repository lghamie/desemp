<!DOCTYPE html>
<html>

<head>
    <title>Findepto</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta charset="utf-8">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.3/css/bootstrap.min.css" integrity="sha384-MIwDKRSSImVFAZCVLtU0LMDdON6KVCrZHyVQQj6e8wIEJkW4tvwqXrbMIya1vriY" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css">


    <style>
    html,
    body {
        height: 100%;
        margin: 0;
        padding: 0;
    }

    .carousel-img{
    width: 100%; /* use this, or not */
    margin: auto;
    }
    .carousel-margin{
        margin-bottom: 10px;
    }
    #map {
        height: 100%;
    }
    </style>
</head>

<body>
    <div id="map"></div>
    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog " role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel">Ambrosetti 800 <small class="text-muted"> Caballito</small> </h4>
          </div>
          <div class="modal-body">
            <div class="container-fluid" id="modalcontent">
          </div>
        </div>
      </div>
    </div>
    <script   src="https://code.jquery.com/jquery-3.1.0.min.js"   integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s="   crossorigin="anonymous"></script>
    <script src="https://www.atlasestateagents.co.uk/javascript/tether.min.js"></script><!-- Tether for Bootstrap -->
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.3/js/bootstrap.min.js" integrity="sha384-ux8v3A6CPtOTqOzMKiuo3d/DomGaaClxFYdCu2HPMBEkf6x2xiDyJ7gkXU0MWwaD" crossorigin="anonymous"></script>

    <script>
    var descHouseHtml;
    $.get("housedesc.html", function( html ) {
        $('#modalcontent').html(html);
    });
    var map;
    var openedInfowindow = false;

    function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
            center: {
                lat: -34.59,
                lng: -58.432159
            },
            zoom: 14
        });
        var infoWindow = new google.maps.InfoWindow({
            maxWidth: 120
        });
        openedInfowindow = infoWindow;
        // Try HTML5 geolocation.
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                var pos = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };
                map.setCenter(pos);
                infoWindow.setPosition(map.getCenter());
                infoWindow.setContent('<h3> Bienvenido! </h3> Toca en una propiedad cercana para ver mas información');
            }, function() {
                //handleLocationError(true, infoWindow, map.getCenter());
                infoWindow.setPosition({
                    lat: -34.59,
                    lng: -58.432159
                });
                infoWindow.setContent('<h3> Bienvenido! </h3> Toca en una propiedad cercana para ver mas información');

            });
        } else {
            // Browser doesn't support Geolocation
            //handleLocationError(false, infoWindow, map.getCenter());
            infoWindow.setPosition({
                lat: -34.59,
                lng: -58.432159
            });
            infoWindow.setContent('<h3> Bienvenido! </h3> Toca en una propiedad cercana para ver mas información');
        }
        infoWindow.open(map);
        var houses = [];

        houses.push({
            'address': "Lerma 1555, Buenos Aires",
            latlng: {
                lat: -34.595262,
                lng: -58.434241
            },
            type: "Casa"
        });
        houses.push({
            'address': "Thames 1523, Buenos Aires",
            latlng: {
                lat: -34.595384,
                lng: -58.443371
            },
            type: "Departamento"
        });
        houses.push({
            'address': "Warnes 1237, Buenos Aires",
            latlng: {
                lat: -34.600208,
                lng: -58.449061
            },
            type: "Departamento"
        });
        houses.push({
            'address': "Ambrosetti 800, Caballito, CABA",
            latlng: {
                lat: -34.6087931,
                lng: -58.438769
            },
            type: "Departamento"
        });
        drawAvailableHouses(map, houses);

    }

    function drawAvailableHouses(map, houses) {
        for (var i = 0; i < houses.length; i++) {
            drawHouse(houses[i]);
        }
    }

    function drawHouse(house) {
/*
        var contentString = '<div id="content">' +
            '<div id="siteNotice">' +
            '</div>' +
            '<h1 id="firstHeading" class="firstHeading">' + house.address + '</h1>' +
            '<div id="bodyContent">' +
            '<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large ' +
            'sandstone rock formation in the southern part of the ' +
            'Northern Territory, central Australia. It lies 335&#160;km (208&#160;mi) ' +
            'south west of the nearest large town, Alice Springs; 450&#160;km ' +
            'Heritage Site.</p>' +
            '<p>Attribution: Uluru, <a href="https://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194">' +
            'https://en.wikipedia.org/w/index.php?title=Uluru</a> ' +
            '(last visited June 22, 2009).</p>' +
            '</div>' +
            '</div>';
*/

        contentString = descHouseHtml;
        var infowindow = new google.maps.InfoWindow({
            content: contentString
        });


        var image = 'unknown.png';

        switch(house.type){
          case "Casa":
            image = 'house.png';
          break;
          case "Departamento":
            image = 'apartment.png';
          break;
        }
        var marker = new google.maps.Marker({
            position: house.latlng,
            map: map,
            icon: image,
        });

        marker.addListener('click', function() {
           /* if (openedInfowindow) {
                openedInfowindow.close();
            }
            openedInfowindow = infowindow;
            infowindow.open(map, marker);
            */
            $('#myModal').modal('show');
        });
           // $('#myModal').modal('show');

    }

    function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
            'Error: The Geolocation service failed.' :
            'Error: Your browser doesn\'t support geolocation.');
    }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDTZSkFnCcMkVsbJ58f7auW0N6gECpX2qw&callback=initMap" async defer></script>
</body>

</html>
